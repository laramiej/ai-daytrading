# AI Analysis Logging Guide

The system now includes comprehensive logging that shows exactly what data the AI receives and what it outputs.

## What Gets Logged

### 1. Analysis Input Summary

Before the AI analyzes a stock, you'll see:

```
======================================================================
üìä AI ANALYSIS INPUT SUMMARY FOR AAPL
======================================================================
üíµ PRICE DATA:
  Current: $175.50
  Open: $174.20
  High: $176.80
  Low: $173.50
  Volume: 45,234,567
  Change: +0.75%

üìà TECHNICAL INDICATORS:
  RSI(14): 62.34 (Neutral)
  MACD: 1.23, Signal: 0.98
  MACD Histogram: 0.25
  Bollinger Bands: Upper $178.45, Middle $175.20, Lower $171.95
  SMA(20): $174.80, SMA(50): $172.40
  EMA(12): $175.10, EMA(26): $173.90

üé≠ MARKET SENTIMENT:
  Overall: Bullish (Score: 0.45)

üì∞ AAPL SENTIMENT:
  Overall: Positive (Score: 0.35)
  News: Positive
  Analysts: Buy
  Momentum: Strong

üì∞ RECENT NEWS: (3 headlines)
  1. Apple announces new product line with strong pre-orders...
  2. Tech sector rallies on positive economic data...
  3. Analysts upgrade AAPL target price to $190...
======================================================================
```

### 2. Portfolio Context

After market data, you'll see portfolio information:

```
Portfolio context for AAPL:
  Can BUY: True
  Can SELL: True
    - No position held - SELL would be a short sale
```

Or if you own the stock:

```
Portfolio context for AAPL:
  Can BUY: True
  Can SELL: True
    - Currently holding 10 shares
```

### 3. LLM Request

```
Sending analysis request to anthropic...
```

### 4. Analysis Output Summary

After the AI completes analysis:

```
======================================================================
ü§ñ AI ANALYSIS OUTPUT FOR AAPL
======================================================================
üü¢ SIGNAL: BUY
üìä CONFIDENCE: 75%
   (High confidence)

üí≠ REASONING:
   Strong technical setup with RSI in neutral zone showing room for
   upside. MACD positive crossover confirmed. Price breaking above
   SMA(20) with bullish sentiment from both news and analysts.
   Recommend entry on pullback to $174 support.

üéØ PRICE TARGETS:
   Entry: $174.50
   Stop Loss: $171.00
   Take Profit: $182.00

üìè POSITION SIZE: MEDIUM

‚ö†Ô∏è  RISK FACTORS:
   - Market volatility elevated
   - Approaching resistance level at $178
   - General tech sector may be overbought

‚è∞ TIME HORIZON: 2-4 hours

üîß GENERATED BY: anthropic
======================================================================
```

## Log Interpretation Guide

### RSI Interpretation

```
RSI < 30      ‚Üí (Oversold) - Potential buying opportunity
RSI 30-70     ‚Üí (Neutral) - Normal range
RSI > 70      ‚Üí (Overbought) - Potential selling opportunity
```

### MACD Signals

```
MACD > Signal     ‚Üí Bullish crossover
MACD < Signal     ‚Üí Bearish crossover
Histogram > 0     ‚Üí Bullish momentum
Histogram < 0     ‚Üí Bearish momentum
```

### Bollinger Bands

```
Price near Upper Band  ‚Üí Potential overbought
Price near Lower Band  ‚Üí Potential oversold
Price at Middle Band   ‚Üí Fair value/mean reversion
```

### Confidence Levels

```
80-100%  ‚Üí Very High confidence
70-79%   ‚Üí High confidence
60-69%   ‚Üí Moderate confidence
50-59%   ‚Üí Low confidence
0-49%    ‚Üí Very Low confidence
```

### Signal Types

```
üü¢ BUY   ‚Üí AI recommends buying (going long)
üî¥ SELL  ‚Üí AI recommends selling (closing long or shorting)
‚ö™ HOLD  ‚Üí AI recommends no action
```

## Where Logs Are Stored

### Console Output

All logs appear in your terminal/console in real-time as the bot runs.

### Log File

All logs are also saved to:

```
logs/trading.log
```

You can review this file to see the complete history of:
- What data the AI analyzed
- What decisions it made
- Why it made those decisions
- Trade executions
- Errors and warnings

## Viewing Logs

### Real-time (Console)

When you run the bot, logs appear automatically:

```bash
python src/main.py
```

### Review Log File

View recent logs:

```bash
tail -100 logs/trading.log
```

Search for specific stock:

```bash
grep "AAPL" logs/trading.log
```

View all AI decisions:

```bash
grep "SIGNAL:" logs/trading.log
```

View only BUY signals:

```bash
grep "üü¢ SIGNAL: BUY" logs/trading.log
```

### Monitor Logs in Real-Time

Watch logs as they're written:

```bash
tail -f logs/trading.log
```

Press `Ctrl+C` to stop watching.

## Log Levels

The system uses different log levels:

```
INFO    ‚Üí Normal operations and analysis
WARNING ‚Üí Potential issues (not blocking)
ERROR   ‚Üí Problems that prevent operations
DEBUG   ‚Üí Detailed technical information (disabled by default)
```

## Example Complete Analysis Log

Here's what a complete analysis cycle looks like:

```
2026-01-15 10:30:15 - INFO - Analyzing AAPL with anthropic

======================================================================
üìä AI ANALYSIS INPUT SUMMARY FOR AAPL
======================================================================
üíµ PRICE DATA:
  Current: $175.50
  Open: $174.20
  High: $176.80
  Low: $173.50
  Volume: 45,234,567
  Change: +0.75%

üìà TECHNICAL INDICATORS:
  RSI(14): 62.34 (Neutral)
  MACD: 1.23, Signal: 0.98
  MACD Histogram: 0.25
  Bollinger Bands: Upper $178.45, Middle $175.20, Lower $171.95
  SMA(20): $174.80, SMA(50): $172.40
  EMA(12): $175.10, EMA(26): $173.90

üì∞ RECENT NEWS: (3 headlines)
  1. Apple announces new product line with strong pre-orders...
  2. Tech sector rallies on positive economic data...
  3. Analysts upgrade AAPL target price to $190...
======================================================================

2026-01-15 10:30:16 - INFO - Portfolio context for AAPL:
2026-01-15 10:30:16 - INFO -   Can BUY: True
2026-01-15 10:30:16 - INFO -   Can SELL: True

2026-01-15 10:30:16 - INFO - Sending analysis request to anthropic...

2026-01-15 10:30:18 - INFO - ======================================
2026-01-15 10:30:18 - INFO - ü§ñ AI ANALYSIS OUTPUT FOR AAPL
2026-01-15 10:30:18 - INFO - ======================================
2026-01-15 10:30:18 - INFO - üü¢ SIGNAL: BUY
2026-01-15 10:30:18 - INFO - üìä CONFIDENCE: 75%
2026-01-15 10:30:18 - INFO -    (High confidence)
2026-01-15 10:30:18 - INFO - üí≠ REASONING:
2026-01-15 10:30:18 - INFO -    Strong technical setup with bullish indicators
2026-01-15 10:30:18 - INFO - üéØ PRICE TARGETS:
2026-01-15 10:30:18 - INFO -    Entry: $174.50
2026-01-15 10:30:18 - INFO -    Stop Loss: $171.00
2026-01-15 10:30:18 - INFO -    Take Profit: $182.00
2026-01-15 10:30:18 - INFO - üìè POSITION SIZE: MEDIUM
2026-01-15 10:30:18 - INFO - ‚ö†Ô∏è  RISK FACTORS:
2026-01-15 10:30:18 - INFO -    - Market volatility elevated
2026-01-15 10:30:18 - INFO - ‚è∞ TIME HORIZON: 2-4 hours
2026-01-15 10:30:18 - INFO - üîß GENERATED BY: anthropic
2026-01-15 10:30:18 - INFO - ======================================
```

## Benefits of Detailed Logging

### 1. Transparency

You can see exactly what data influenced the AI's decision.

### 2. Learning

Understand which indicators the AI values most by reviewing successful trades.

### 3. Debugging

If the AI makes unexpected recommendations, you can see why by reviewing the input data.

### 4. Backtesting

Review historical logs to understand what data was available at decision time.

### 5. Confidence

Know that the AI is considering comprehensive market data, not just price.

### 6. Audit Trail

Complete record of all analyses and decisions for compliance or review.

## Customizing Log Level

### Show More Detail

Edit `src/main.py` line 18:

```python
logging.basicConfig(
    level=logging.DEBUG,  # Changed from INFO to DEBUG
    ...
)
```

### Show Less Detail

```python
logging.basicConfig(
    level=logging.WARNING,  # Only warnings and errors
    ...
)
```

## Tips for Using Logs

### 1. Compare Input to Output

Check if the AI's reasoning aligns with the technical indicators it received.

### 2. Track Confidence vs. Success

Review logs to see if high-confidence signals perform better.

### 3. Identify Pattern

Look for common input patterns in successful vs. unsuccessful trades.

### 4. Monitor Portfolio Context

Ensure the AI is aware of your current positions.

### 5. Verify Data Quality

Check that price and technical data look reasonable.

## Common Log Patterns

### Bullish Setup

```
RSI: 45 (Neutral)
MACD Histogram: Positive and growing
Price: Above SMA(20) and SMA(50)
News Sentiment: Positive
‚Üí AI likely to generate BUY signal
```

### Bearish Setup

```
RSI: 75 (Overbought)
MACD Histogram: Negative and declining
Price: Near upper Bollinger Band
News Sentiment: Negative
‚Üí AI likely to generate SELL signal
```

### Neutral/Uncertain

```
RSI: 50 (Neutral)
MACD: Near zero
Price: Between moving averages
Mixed sentiment
‚Üí AI likely to generate HOLD signal or low-confidence signal
```

## Log File Management

### Prevent Log Files from Growing Too Large

The log file will grow over time. To manage it:

**Archive old logs:**
```bash
mv logs/trading.log logs/trading_$(date +%Y%m%d).log
```

**Clear logs:**
```bash
> logs/trading.log  # Empties the file
```

**Automatic rotation** (add to your system's cron/scheduler):
```bash
# Keep last 7 days of logs
find logs/ -name "trading*.log" -mtime +7 -delete
```

## Summary

The new logging gives you complete visibility into:

‚úÖ **What data** the AI receives
‚úÖ **How it interprets** technical indicators
‚úÖ **What decision** it makes
‚úÖ **Why it makes** that decision
‚úÖ **Portfolio context** it considers
‚úÖ **Risk factors** it identifies

This transparency helps you:
- Trust the AI's recommendations
- Learn from successful trades
- Understand unsuccessful trades
- Debug any issues
- Improve your trading strategy

---

**Pro Tip**: Keep logs/trading.log open in a second terminal window while running the bot to watch the AI's decision-making process in real-time!
